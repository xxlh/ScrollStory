/*
 * storyscroll v3.6.2
 * (c) 2020 Little Linghuan & Esone
 * Released under the GPL license
 * ieexx.com
 */

!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("storyscroll"),require("gsap/TweenMax")):"function"==typeof define&&define.amd?define(["exports","storyscroll","gsap/TweenMax"],o):o((t=t||self)["StoryScroll-Action"]={},t.StoryScroll,t.TweenMax)}(this,function(t,o,i){"use strict";o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,o.prototype.pointActions=[];const e=o.prototype._setActions;o.prototype._setActions=function(s){e.call(this,s),s.act=(t,o)=>this.act(s,t,o),s.action=(t,o,e)=>this.action(s,t,o,e)},o.prototype._getCommonProps=function(t,o){let e={};for(const s in o)t[s]||"function"==typeof o[s]||(e[s]=o[s]);return e};var s=(o.prototype.act=function(t,o,e){var s=this._getCommonProps(t,o);for(const r in t.tweens=t.tweens||[],o)if("object"==typeof o[r]&&t[r]){const n=i.to(t[r],e,{...o[r],...s});-1==s.repeat&&t.tweens.push(n),delete o[r]}const n=i.to(t,e,o);-1==o.repeat&&t.tweens.push(n)},o.prototype.act),n=(()=>{o.prototype.action=function(t,o,e,s){void 0===s&&(s=this._getSpriteTriggerPosition(t)),t.actions||(t.actions={});var n,r=this._getCommonProps(t,o);for(const p in o)"object"==typeof o[p]&&t[p]&&(n=this._createHash(8),t.actions[n]={action:{type:"point",propsRoot:p,props:{...o[p],...r},duration:e,triggerPosition:s}},this.pointActions.push({sprite:t,hash:n,...t.actions[n].action}),delete o[p]);var i=this._createHash(8);return t.actions[i]={action:{type:"point",props:o,duration:e,triggerPosition:s}},this.pointActions.push({sprite:t,hash:i,...t.actions[i].action}),t};const s=o.prototype._scrollerCallback;return o.prototype._scrollerCallback=function(t,o,e){s.call(this,t,o,e),this.pointActions.forEach(t=>{(function(o){let e=o.sprite.actions[o.hash];if(this.storyPosition>=o.triggerPosition){if("acting"!=e.status&&"done"!=e.status){var s=o.propsRoot?o.sprite[o.propsRoot]:o.sprite;let t={...o.props};t.onComplete=function(){e.status="done",o.props.onComplete&&o.props.onComplete.call(this)},t.onReverseComplete=function(){e.status="reversed",o.props.onReverseComplete&&o.props.onReverseComplete.call(this)};s=i.to(s,o.duration,t);e.tween=s,e.status="acting",o.sprite.tweens=o.sprite.tweens||[],-1==o.props.repeat&&o.sprite.tweens.push(s)}}else!1!==o.props.reverse&&("acting"!=e.status&&"done"!=e.status||e.tween&&(e.status="reversing",e.tween.reverse()))}).call(this,t)})},o.prototype.action})(),r={act:s,action:n};t.act=s,t.action=n,t.default=r,Object.defineProperty(t,"__esModule",{value:!0})});